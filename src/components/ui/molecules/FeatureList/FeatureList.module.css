/* src/components/ui/molecules/FeatureList/FeatureList.module.css
   Brand-aligned, responsive, container-query enhanced.

   Consumes tokens from packages-unified.module.css → unified-theme.css/root.css.
   TSX contract: root, sm|md, item, iconWrap, icon, content, label, note,
                 hasTooltip, infoBtn, infoIcon, tooltip,
                 and state classes: included, limited, addon, excluded.
*/

/* ============================== ROOT LIST =============================== */
.root {
    /* Design-system mappings (override via parent island if needed) */
    --feature-fg: var(--pkg-text, var(--text-primary, #f4f6f7));
    --feature-fg-dark: var(--pkg-text, var(--text-primary, #f4f6f7));
    --feature-info: var(--text-tertiary, #94a3b8);
    --feature-included: var(--success, #16a34a);
    --feature-limited: var(--pill-limited-fg, #b45309);
    --feature-addon: var(--pill-addon-fg, #2563eb);
    --feature-excluded: var(--text-tertiary, #9ca3af);
    --tooltip-bg: var(--bg-elevated, #121224);
    --tooltip-fg: var(--text-primary, #f8fafc);
    --tooltip-border: var(--border-subtle, #3b3b3b);

    margin: 0;
    padding: 0;
    list-style: none;

    color: var(--feature-fg);
    font-variant-numeric: tabular-nums;

    /* Let the list scale with the surrounding column/card */
    container-type: inline-size;

    /* Alignment controls (set via data-* for zero-specificity override) */
    justify-items: start;
    /* default */
}

.root[data-align="center"] {
    justify-items: center;
}

.root[data-align="end"] {
    justify-items: end;
}

/* Text alignment controls (labels + notes) */
.root[data-text="left"] .content {
    text-align: left;
}

.root[data-text="center"] .content {
    text-align: center;
}

.root[data-text="right"] .content {
    text-align: right;
}

/* Also align inline-flex label row to match text intent */
.root[data-text="left"] .label {
    justify-content: flex-start;
}

.root[data-text="center"] .label {
    justify-content: center;
}

.root[data-text="right"] .label {
    justify-content: flex-end;
}

/* ============================== DENSITY ================================ */
.md,
.sm {
    display: grid;
}

.md {
    row-gap: var(--spacing-sm, 0.5rem);
}

.sm {
    row-gap: var(--spacing-xs, 0.375rem);
}

/* =============================== ITEM ================================== */
.item {
    display: grid;
    grid-template-columns: var(--_icon-col, 1.25rem) 1fr;
    column-gap: var(--spacing-xs, 0.5rem);
    align-items: start;
    min-inline-size: 0;
    /* avoid overflow in tight grids */
}

/* Icon cell -------------------------------------------------------------- */
.iconWrap {
    line-height: 1;
    inline-size: var(--_icon-col, 1.25rem);
    block-size: var(--_icon-col, 1.25rem);
    display: inline-grid;
    place-items: center;
    border-radius: var(--radius-sm, 6px);
    /* improves focus ring visuals */
}

.icon {
    inline-size: clamp(0.9rem, 1.2cqi, 1.1rem);
    block-size: clamp(0.9rem, 1.2cqi, 1.1rem);
}

/* Content --------------------------------------------------------------- */
.content {
    display: grid;
    gap: 0.125rem;
    min-inline-size: 0;
}

.label {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    font-weight: 600;
    color: var(--text-primary, currentColor);
    text-wrap: balance;
}

.note {
    font-size: var(--font-size-small, 0.875rem);
    color: var(--text-secondary, var(--pkg-text-muted, #c9ced1));
    opacity: 0.92;
}

/* =============================== STATES ================================ */
.included .iconWrap {
    color: var(--feature-included);
}

/* green */
.limited .iconWrap {
    color: var(--feature-limited);
}

/* amber */
.addon .iconWrap {
    color: var(--feature-addon);
}

/* blue */
.excluded .iconWrap {
    color: var(--feature-excluded);
}

/* gray */

.excluded .label,
.excluded .note {
    opacity: 0.7;
    text-decoration: line-through;
}

/* ============================== TOOLTIP ================================ */
.hasTooltip {
    position: relative;
    display: inline-flex;
    align-items: center;
}

.infoBtn {
    all: unset;
    cursor: help;
    display: inline-grid;
    place-items: center;
    line-height: 1;
    inline-size: 1.15rem;
    block-size: 1.15rem;
    border-radius: var(--radius-sm, 6px);
}

.infoBtn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--brand-blue, #0EAFFB) 45%, white);
}

.infoIcon {
    inline-size: 0.9rem;
    block-size: 0.9rem;
    color: var(--feature-info);
}

/* Popover */
.tooltip {
    position: absolute;
    inset-inline-start: 50%;
    transform: translateX(-50%);
    inset-block-end: calc(100% + 0.375rem);

    max-inline-size: min(72cqi, 22rem);
    min-inline-size: max-content;

    padding: 0.375rem 0.5rem;
    border-radius: var(--radius-md, 8px);
    font-size: 0.8125rem;

    background-color: var(--tooltip-bg);
    color: var(--tooltip-fg);
    border: 1px solid var(--tooltip-border);
    box-shadow: var(--shadow-lg, 0 8px 24px rgba(2, 6, 23, 0.25));

    opacity: 0;
    pointer-events: none;
    z-index: 20;

    transition: opacity var(--transition-fast, 120ms ease);
}

/* Little arrow */
.tooltip::after {
    content: "";
    position: absolute;
    inset-inline-start: 50%;
    transform: translateX(-50%) rotate(45deg);
    inset-block-start: 100%;
    inline-size: 8px;
    block-size: 8px;
    background: var(--tooltip-bg);
    border-inline-start: 1px solid var(--tooltip-border);
    border-block-start: 1px solid var(--tooltip-border);
}

/* Show on hover/focus */
.hasTooltip:hover .tooltip,
.hasTooltip:focus-within .tooltip {
    opacity: 1;
    pointer-events: auto;
}

/* =========================== RESPONSIVENESS ============================ */
/* Scale icon column + spacing based on container width (not viewport) */
@container (min-width: 30rem) {
    .item {
        grid-template-columns: var(--_icon-col, 1.35rem) 1fr;
    }
}

@container (min-width: 48rem) {
    .item {
        grid-template-columns: var(--_icon-col, 1.5rem) 1fr;
    }

    .md {
        row-gap: var(--spacing-md, 0.75rem);
    }
}

/* Viewport fallback when container queries aren’t supported -------------- */
@media (max-width: 640px) {
    .md {
        row-gap: var(--spacing-xs, 0.5rem);
    }

    .icon {
        inline-size: 1rem;
        block-size: 1rem;
    }
}

/* ============================== ACCESSIBILITY ========================== */
@media (prefers-reduced-motion: reduce) {
    .tooltip {
        transition: none !important;
    }
}

@media (forced-colors: active) {
    .tooltip {
        background: Canvas;
        color: CanvasText;
        border-color: ButtonText;
        box-shadow: none;
    }
}

/* ================================ DARK HOOK ============================ */
@media (prefers-color-scheme: dark) {
    .root {
        color: var(--feature-fg-dark);
    }
}

/* ================================ PRINT =============================== */
@media print {
    .tooltip {
        display: none !important;
    }
}