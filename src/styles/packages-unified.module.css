/* --------------------------------------------------------------------------
   TBH Digital Solutions — Packages Unified (CSS Module, local scope)
   Purpose
     • Opt-in theme island for Packages Hub & Detail pages.
     • Expose package-scoped alias vars that map to global tokens
       (from unified-theme.css / root.css).
   Notes
     • No :root / :global here (CSS Modules “pure”).
     • Apply on a container: className={styles.packagesTheme}
     • Container-aware: this module enables container queries on key wrappers.
---------------------------------------------------------------------------- */

/* 1) Theme island (dark-first) ------------------------------------------- */
.packagesTheme {
    /* ---- Color aliases (map to global tokens) ---- */
    --pkg-bg: var(--bg-primary, #060512);
    --pkg-section: var(--bg-elevated, #0E1730);
    --pkg-surface: var(--bg-surface, #0B0A18);
    --pkg-elevated: var(--bg-elevated, #121224);

    --pkg-text: var(--text-primary, #f4f6f7);
    --pkg-text-muted: var(--text-secondary, #c9ced1);
    --pkg-text-accent: var(--text-accent, #0EAFFB);

    --pkg-brand: var(--brand-blue, #0EAFFB);

    /* ---- Card recipe (frames rely on these) ---- */
    --pkg-card-bg: var(--card-bg, var(--pkg-surface));
    --pkg-card-fg: var(--card-fg, var(--pkg-text));
    --pkg-card-border: var(--card-border, var(--border-subtle));
    --pkg-card-border-hover: var(--card-border-hover, var(--border-strong));
    --pkg-card-hover-bg: var(--card-hover-bg, color-mix(in oklab, var(--pkg-surface) 92%, white));
    --pkg-card-shadow-rest: var(--card-shadow-rest, var(--shadow-sm));
    --pkg-card-shadow-hover: var(--card-shadow-hover, var(--shadow-lg));
    --pkg-card-ring: var(--card-ring, color-mix(in oklab, var(--pkg-brand) 45%, white));
    --pkg-card-selected: var(--card-selected, color-mix(in oklab, var(--pkg-brand) 75%, #7c3aed));

    /* ---- Emphasis (frames fall back to these) ---- */
    --addon-ring: var(--addon-ring, color-mix(in oklab, var(--pkg-brand) 65%, white));
    --addon-selected: var(--addon-selected, color-mix(in oklab, var(--pkg-brand) 80%, #1b2437));
    --package-ring: var(--package-ring, color-mix(in oklab, var(--pkg-brand) 70%, white));
    --package-selected: var(--package-selected, color-mix(in oklab, var(--pkg-brand) 82%, #274d8c));

    /* ---- Chips / pills ---- */
    --chip-price-bg: var(--chip-price-bg, #2D2D2F);
    --chip-price-fg: var(--chip-price-fg, var(--pkg-text));

    /* ---- Tables / matrices ---- */
    --pkg-table-bg: var(--table-bg, var(--pkg-surface));
    --pkg-table-head-bg: var(--table-head-bg, color-mix(in oklab, var(--pkg-surface) 80%, var(--pkg-bg)));
    --pkg-table-border: var(--table-border, var(--border-subtle));
    --pkg-table-stripe: var(--table-stripe, color-mix(in oklab, var(--pkg-surface) 92%, white));

    /* ---- Includes pills (limited/add-on) ---- */
    --pill-limited-fg: var(--pill-limited-fg, #b45309);
    --pill-limited-bg: var(--pill-limited-bg, color-mix(in oklab, #b45309 16%, var(--pkg-surface)));
    --pill-limited-br: var(--pill-limited-br, color-mix(in oklab, #b45309 32%, var(--pkg-surface)));

    --pill-addon-fg: var(--pill-addon-fg, #2563eb);
    --pill-addon-bg: var(--pill-addon-bg, color-mix(in oklab, #2563eb 16%, var(--pkg-surface)));
    --pill-addon-br: var(--pill-addon-br, color-mix(in oklab, #2563eb 32%, var(--pkg-surface)));

    /* ---- Carousel controls ---- */
    --carousel-btn-bg: var(--carousel-btn-bg, color-mix(in oklab, var(--pkg-surface) 75%, black));
    --carousel-btn-fg: var(--carousel-btn-fg, var(--pkg-text));
    --carousel-btn-border: var(--carousel-btn-border, var(--pkg-card-border));

    /* ---- Typography ---- */
    --pkg-h1: var(--font-size-h1, clamp(2rem, 2.5vw + 1rem, 3rem));
    --pkg-h2: var(--font-size-h2, clamp(1.5rem, 1.6vw + 0.9rem, 2rem));
    --pkg-h3: var(--font-size-h3, clamp(1.25rem, 1.1vw + 0.7rem, 1.5rem));
    --pkg-body: var(--font-size-body, clamp(1rem, 0.4vw + 0.9rem, 1.125rem));

    /* ---- Spacing / radii / motion ---- */
    --pkg-space-2xs: var(--spacing-2xs, 0.25rem);
    --pkg-space-xs: var(--spacing-xs, 0.5rem);
    --pkg-space-sm: var(--spacing-sm, 0.75rem);
    --pkg-space-md: var(--spacing-md, 1rem);
    --pkg-space-lg: var(--spacing-lg, 1.25rem);
    --pkg-space-xl: var(--spacing-xl, 1.5rem);
    --pkg-space-2xl: var(--spacing-2xl, 2rem);

    --pkg-radius-sm: var(--radius-sm, 6px);
    --pkg-radius-md: var(--radius-md, 10px);
    --pkg-radius-lg: var(--radius-lg, 14px);
    --pkg-radius-xl: var(--radius-xl, 20px);

    --pkg-ease-fast: var(--transition-fast, 120ms ease);
    --pkg-ease: var(--transition-standard, 160ms ease);
    --pkg-ease-slow: var(--transition-slow, 240ms ease);

    /* ---- Structure ---- */
    --pkg-container-max: var(--container-max, 1200px);
    --pkg-container-pad-inline: var(--container-pad-inline, 1rem);
    --pkg-section-pad: var(--section-pad-block, 3.5rem);
    --pkg-section-pad-lg: var(--section-pad-block-lg, 5rem);

    /* ---- Gradients ---- */
    --gradient-section: var(--gradient-section, linear-gradient(180deg, var(--pkg-bg) 0%, var(--pkg-section) 100%));

    color: var(--pkg-text);
    background: var(--pkg-bg);

    /* Allow components inside to use color-scheme if needed */
    color-scheme: dark;
}

/* 2) Optional light variant ---------------------------------------------- */
.packagesLight {
    --pkg-bg: #ffffff;
    --pkg-section: #f7f9fb;
    --pkg-surface: #ffffff;

    --pkg-text: #0f172a;
    --pkg-text-muted: #334155;
    --pkg-text-accent: var(--brand-blue, #0EAFFB);

    --pkg-card-bg: #ffffff;
    --pkg-card-fg: #0f172a;
    --pkg-card-border: #e2e8f0;
    --pkg-table-head-bg: #f8fafc;

    color-scheme: light;
}

/* 3) Convenience helpers (drop-in section patterns) ---------------------- */
.packagesBand {
    padding-block: var(--pkg-section-pad);
    background: var(--gradient-section);
    border-radius: var(--pkg-radius-xl);
}

/* Stronger vertical rhythm band */
.packagesBand--major {
    padding-block: var(--pkg-section-pad-lg);
}

.packagesContainer {
    inline-size: min(calc(100% - 2 * var(--pkg-container-pad-inline)), var(--pkg-container-max));
    margin-inline: auto;
    padding-inline: var(--pkg-container-pad-inline);
    /* Enable container queries for child components */
    container-type: inline-size;
    container-name: packages;
    /* Prevent accidental overflow in nested grids */
    min-inline-size: 0;
}

.packagesSectionHeader {
    text-align: center;
    max-inline-size: 60ch;
    margin: 0 auto var(--pkg-space-xl);
}

.packagesSectionTitle {
    font-family: var(--font-heading, Aldrich, sans-serif);
    font-size: var(--pkg-h2);
    color: var(--pkg-text-accent);
    margin: 0 0 var(--pkg-space-sm);
    text-wrap: balance;
}

.packagesSectionSubtitle {
    font-family: var(--font-body, Newsreader, serif);
    font-size: var(--pkg-body);
    color: var(--pkg-text-muted);
    margin: 0;
    text-wrap: pretty;
    line-height: 1.6;
}

/* 4) Universal heading stack utilities ----------------------------------- */
/* These are reused by Overview & Extras to render: Title + Divider + Tagline */
.hgroup {
    display: grid;
    justify-items: center;
    /* centers the whole header group */
    gap: var(--pkg-space-xs);
    margin-block: var(--pkg-space-md) var(--pkg-space-sm);
}

.hpair {
    display: inline-grid;
    justify-items: center;
    /* centers title + divider inside */
    inline-size: max-content;
    /* ← makes Divider match the title width */
    max-inline-size: 100%;
    min-inline-size: 0;
}

.hTitle {
    margin: 0;
    text-align: center;
    text-wrap: balance;
}

.hRule {
    /* The Divider atom will fill this container; we provide a stable bound. */
    inline-size: clamp(120px, 40cqi, 560px);
    margin-inline: auto;
}

.hTaglineWrap {
    display: grid;
    justify-items: center;
    /* centers the block itself */
}

.hTagline {
    margin: 0;
    max-inline-size: 68ch;
    text-align: left;
    /* centered block, left-aligned text */
    color: var(--pkg-text-muted);
    line-height: 1.6;
    font-size: clamp(0.95rem, 0.2vw + 0.95rem, 1.05rem);
    text-wrap: pretty;
}

/* 5) Extra token tweaks for package/bundle cards -------------------------- */
.packagesThemeTokens {
    /* Badge & savings pills */
    --pkg-badge-bg: color-mix(in oklab, var(--pkg-brand) 12%, var(--pkg-surface));
    --pkg-badge-fg: var(--pkg-brand);

    --pkg-savings-bg: color-mix(in oklab, #16a34a 18%, var(--pkg-surface));
    --pkg-savings-fg: #16a34a;

    /* Price chip */
    --pkg-pricechip-bg: var(--chip-price-bg, #2D2D2F);
    --pkg-pricechip-fg: var(--chip-price-fg, var(--pkg-text));

    /* Local card text helpers */
    --pkg-card-media-bg: color-mix(in oklab, var(--pkg-surface) 80%, black);
    --pkg-card-title: var(--pkg-text);
    --pkg-card-muted: var(--pkg-text-muted);

    /* Bundle accents (frames fall back if this class isn’t applied) */
    --bundle-ring: color-mix(in oklab, var(--brand-blue) 55%, #7c3aed);
    --bundle-selected: color-mix(in oklab, var(--brand-blue) 70%, #7c3aed);
}

/* Optional: extra spacing before FAQ when present ------------------------ */
.faqBand {
    margin-block-start: 2rem;
}

/* 6) Responsive behavior via container queries --------------------------- */
/* Small (≤ 20rem) */
@container packages (max-width: 20rem) {
    .packagesSectionTitle {
        font-size: clamp(1.25rem, 3cqi + 1rem, 1.5rem);
    }

    .hTagline {
        font-size: clamp(0.95rem, 1.5cqi + 0.85rem, 1.025rem);
    }

    .hgroup {
        gap: var(--pkg-space-2xs);
    }
}

/* Medium (20–32rem) */
@container packages (min-width: 20rem) and (max-width: 32rem) {
    .packagesSectionTitle {
        font-size: clamp(1.375rem, 2.2cqi + 1rem, 1.75rem);
    }
}

/* Large (32–48rem) */
@container packages (min-width: 32rem) and (max-width: 48rem) {
    .packagesSectionTitle {
        font-size: clamp(1.5rem, 1.6cqi + 1rem, 1.9rem);
    }
}

/* XLarge (> 48rem) */
@container packages (min-width: 48rem) {
    .packagesSectionTitle {
        font-size: clamp(1.6rem, 1.2cqi + 1rem, 2rem);
    }
}

/* 7) Accessibility & motion ---------------------------------------------- */
@media (prefers-reduced-motion: reduce) {
    .packagesTheme * {
        transition: none !important;
        animation: none !important;
    }
}

/* High-contrast / forced colors */
@media (forced-colors: active) {

    .packagesBand,
    .packagesBand--major {
        background: Canvas !important;
        border: 1px solid CanvasText;
    }

    .hTitle {
        color: CanvasText !important;
    }

    .hTagline {
        color: CanvasText !important;
    }
}

/* 8) Print-friendly tweaks ------------------------------------------------ */
@media print {

    .packagesBand,
    .packagesBand--major {
        background: none !important;
        box-shadow: none !important;
    }

    .packagesContainer {
        inline-size: 100%;
        padding-inline: 0;
        container-type: normal;
        /* avoid unexpected print artifacts */
    }
}

/* 9) Heading stack safety guards (scoped) -------------------------------- */
/* Ensure visual centering is honored even if a parent sets left alignment */
:where(.hgroup) .hTitle {
    text-align: center;
}

/* Keep the underline sized & centered by the stack – never full width */
:where(.hRule) {
    inline-size: clamp(120px, 40cqi, 560px);
    margin-inline: auto;
}

/* Defensive reset for any generic hr/divider dropped into the stack */
:where(.hpair) :is(hr, .divider) {
    inline-size: 100%;
    /* 100% of the hpair, which is max-content */
    margin-inline: auto;
    /* center within the hpair */
    block-size: var(--divider-thickness, 4px);
}

